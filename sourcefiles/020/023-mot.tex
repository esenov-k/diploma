\subsection{Категоризация МОТ}

В виду того, что МОТ является довольной комплексной областью исследования, разделение на группы является достаточно сложной задачей. Категоризация на следующие группы является наиболее универсальной, так как охватывает основные черты МОТ~\cite{Article::Luo2021}: 

\begin{enumerate}

	\item Категоризация по методу инициализации: 
		
	\begin{itemize}
		
		\item Слежение с обнаружением (Detection-Based Tracking (DBT))~\cite{Bose2007, Song2010}: Объекты сначала обнаруживаются, а затем связываются в траектории. Этот метод фокусируется на конкретных типах целей, таких как пешеходы, транспортные средства или лица;
		
		\item Слежение без обнаружения (Detection-Free Tracking (DFT))~\cite{Zhang2013}: Требует ручной инициализации фиксированного количества объектов в первом кадре, затем локализует эти объекты в последующих кадрах.
	
	\end{itemize}
	
	\item Категоризация по режиму обработки:
	
	\begin{itemize}
		
		\item Онлайн-отслеживание~\cite{Xiang2015}: Обрабатывает последовательность изображений пошагово, используя наблюдения, доступные до текущего момента;
		
		\item Оффлайн-отслеживание: Использует пакет кадров для обработки данных, требует предварительного получения наблюдений со всех кадров.
		
	\end{itemize}
	
	\item Категоризация по типу вывода:
	
	\begin{itemize}
		
		\item Стохастическое отслеживание: Результаты варьируются от одного запуска к другому из-за случайности в процессе генерации частиц или других элементов;
		
		\item Детерминированное отслеживание: Результаты остаются постоянными при многократном запуске методов.
		
	\end{itemize}
	
\end{enumerate}

Так как система МОТ будет использована в автономном транспорте, то нам необходимы алгоритмы слежения с обнаружением в онлайн режиме. Таким образом, надо подобрать такие системы детекции и трекинга, которые будут удовлетворять нашим требованиям.

\subsection{Методы детекции}

Проблема детекции объекта на изображении или видео, стоит давно. Современные технологии позволяют довольно точно определять что изображено на картинке или видео. Рассмотрим несколько популярных методов детекции и проведем сравнение.

\textbf{Метод градиентов (Histogram of Oriented Gradients(HOG))}

Метод градиентов появился в 2005 году Навнеетом Далалом и Биллом Триггсом. Данный способ заключается в том, что с помощью распределения градиентов интенсивности или направлений краев определяется форма объекта и его внешний вид. На изображениях \ref{fig::HOG_1} и \ref{fig::HOG_2} показано как распределяется градиент в изображении.

\img[htb]{fig::HOG_1}{HOG_1.png}{Распределение векторов градиента}{0.8}

Из плюсов можно выделить вычислительную эффективность: метод довольно эффективен и может быть реализован для работы в реальном времени на современном аппаратном обеспечении и имеет широкую область применения для задач обнаружения пешеходов, транспортных средств, лиц и других объектов. 

\img[htb]{fig::HOG_2}{HOG_2.png}{Пример определения формы объекта при помощи HOG}{0.8}

Однако у HOG есть ряд минусов, которые не позволяют его использовать для МОТ: игнорирование цвета, что не позволит различить объекты друг от друга, неустойчивость к изменению масштаба и ориентации объекта, чувствительность к шумам и плохая работа с динамическими сценами.  

\textbf{Сверточные нейронные сети (СНС)}

Сверточные нейронные сети --- это класс глубоких нейронных сетей, которые используются в компьютерном зрении для анализа визуальных данных. 

Благодаря своим алгоритмам, СНС способны распознавать объекты независимо от их положения в изображении, а также способны автоматически выявлять важные признаки без предварительного определения их в ручную. Но из-за высокой вычислительной сложности СНС требует значительных вычислительных ресурсов и большего количества времени на обработку изображения, что является критически важным фактором для МОТ. Долгая обработка не позволит использовать данный метод в реальном времени.

\textbf{Single Shot Detector (SSD)}

Single Shot Detector (SSD) --- это метод детекции объектов, используемый в компьютерном зрении для обнаружения множества объектов на изображении в один проход. Это делает данный способ особенно полезным для приложений в реальном времени, таких как видеонаблюдение или автономное вождение, где требуется быстрое и эффективное распознавание. Одним из главных преимуществ SSH является скорость. Благодаря своим алгоритмам, SSD может оценить сетку ограничивающих рамок и вероятности классов для этих рамок одновременно, что позволяет достичь скорости, которую можно использовать в реальном времени. Также, благодаря архитектуре, SSD проще в реализации и тренировке по сравнению с вышеперечисленными методами.

Несмотря на все преимущества, у SSD есть и ряд недостатков, таких как сложность работы с мелкими объектами и высокая степень ложных положительных срабатываний (особенно в сценах с сложным фоном).

SSD продолжает развиваться, и его варианты, такие как SSD300 (использующий входные изображения размером 300x300 пикселей) и SSD512 (использующий изображения размером 512x512), предлагают различные компромиссы между скоростью и точностью детекции.

\textbf{YOLO(You Only Look Once)}

YOLO или You Only Look Once --- алгоритм детекции объектов, схожий с SSD, также обрабатывает изображение только один раз. Однако, между ними есть ряд различий, таких как различие в архитектуре, скорости и точности. Различие в архитектуре определяет скорость. YOLO делит изображение на сетку, а затем использует набор фильтров, чтобы предсказать все рамки и классификации за один раз (рисунок \ref{fig::YOLO_1}). SSD также предсказывает ограничивающие рамки и классы объектов за один проход, но делает это, применяя серию сверточных фильтров различного размера к множеству признаковых карт, что позволяет обнаруживать объекты разного размера. Таким образом, YOLO более эффективен для обнаружения больших объектов, но может пропустить маленькие из-за фиксированного размера сетки, что не является критичным в рамках автономных автомобилей. 

\img[htb]{fig::YOLO_1}{YOLO_1.png}{Принцип работы YOLO}{1}

Одним из ключевых факторов это скорость. SSD уступают по скорости YOLO, которая способна обрабатывать от десятков до сотен кадров в секунду. 

Таким образом, после небольшого анализа и сравнения методов детекции, наиболее подходящим  в МОТ для автономных автомобилях является YOLO, благодаря своей высокой скорости и точности.

\subsection{Алгоритмы и метрики МОТ}
В зависимости от конечной задачи, алгоритмы МОТ могут отличаться. Как было упомянуто выше, нам  необходимы алгоритмы слежения с обнаружением в онлайн режиме. Рассмотрим основные, наиболее популярные алгоритмы МОТ, которые для этого подходят~\cite{Article::Luo2021}:

\textbf{Фильтр Калмана}
	
Фильтр Калмана ---  это алгоритм, используемый для оценки состояний системы на основе измерений, которые могут содержать шум или быть не полными. В контексте мультиобъектного трекинга (МОТ), фильтр Калмана используется для отслеживания траекторий движения и скоростей нескольких объектов во времени, предсказывая их будущие состояния и корректируя эти предсказания на основе последовательных наблюдений~\cite{Rodriguez2011}. Также, фильтр Калмана используется для обработки шума измерений с датчиков, обеспечивая более гладкие и точные траектории.

Но у фильтра Калмана есть ряд существенных ограничений: 

\begin{enumerate}

	\item Линейность --- классический фильтр Калмана предназначен для линейных систем, и его прямое применение к нелинейным системам может быть неэффективным;
	
	\item Нормальное распределение ошибок --- фильтр Калмана предполагает, что ошибки и шумы имеют гауссовское распределение, что может быть не верно для всех систем.
	
\end{enumerate}

Для нелинейных систем были разработаны аналоги фильтра Калмана, которые пытаются решить некоторые из этих ограничений за счет приближения нелинейных функций.

\textbf{Расширенный Фильтр Калмана}	
	
Расширенный фильтр Калмана --- одна из нелинейных альтернатив фильтра Калмана, которая позволяет работать с нелинейными моделями, что расширяет возможности его применения. 

Основная идея заключается в приближении нелинейных функций системы линейными эквивалентами вокруг текущей оценки состояния. Это достигается с помощью разложения Тейлора первого порядка (или метода Якобианов). Однако это ведет за собой ряд серьезных ограничений: 

\begin{enumerate}

	\item Так как линеаризация проходит в небольшой окрестности оценки состояния, при сильных нелинейностях линеаризация может привести к ошибкам, что потенциально снижает точности оценки;
	
	\item Чувствительность к начальным условиям --- начальная оценка и ошибки могут значительно повлиять на производительность расширенного фильтра Калмана;
	
	\item Вычислительная сложность --- разложение Тейлора, вычисление Якобиана, обновление ковариационных матриц требует значительных вычислительных ресурсов.
	
\end{enumerate}

В отличие от своего линейного аналога, расширенный фильтр Калмана в общем случае не является оптимальным средством оценки (он оптимален, если измерение и модель перехода состояния являются линейными, т.к. в этом случае расширенный фильтр Калмана идентичен обычному)~\cite{Mitzel2011, ExtendetKalmanFilter2023}. 
	
\textbf {Фильтр Частиц}

Фильтр Частиц (последовательный метод Монте-Карло)--- еще одна нелинейная альтернатива Фильтру Калмана. Используется для оценки состояний в нелинейных системах, особенно когда шумы и возмущения не подчиняются гауссовскому распределению. Этот метод широко используется в мультиобъектном трекинге (МОТ), а также в других приложениях, где необходимо оценивать и отслеживать состояния систем в условиях неопределенности. Как ни странно, фильтр Частиц использует "частицы", которые имеют вес, для представления возможных состояний объекта и обновляет их на основе наблюдений, что позволяет эффективно справляться с нелинейностями и нестандартными распределениями шумов, что делает его идеальным для сложных сценариев МОТ. Также, фильтр хорошо подходит для отслеживания объектов в сложных ситуациях, где могут быть резкие маневры, прерывистые траектории или временные искажения~\cite{Yang2009}.

Такие плюсы в отслеживании нелинейных систем требуют значительных вычислительных ресурсов, особенно при большом количестве частиц. Также, от количества частиц зависит качество оценки.

\subsection{Метрики}

Для дальнейшего понимания, подходят ли те или иные алгоритмы, необходимо определить их преимущества и недостатки, конкретно под требуемую задачу. Для этого надо пользоваться метриками, указанными в таблице \ref{tab::metrics}, которые покажут наглядно, в каких местах подходит выбранный алгоритм или нет.

\begin{table}[H]
	\centering
	\caption{Обзор метрик оценки для систем мультиобъектного трекинга (МОТ)}
	\label{tab::metrics}
	\begin{tabularx}{\textwidth}{|X|X|}
		\hline
		Метрика & Описание\\ 
		\hline
		Полнота (Recall) & Доля правильно идентифицированных объектов среди всех реальных объектов \\
		\hline
		Точность (Precision) & Доля правильно идентифицированных объектов среди всех идентифицированных\\
		\hline
		Ложные срабатывания в кадре (False Alarms per Frame(FAF)) & Количество ложных тревог за кадр, усредненное по последовательности \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Accuracy (MODA)) & Комбинация пропущенных обнаружений и FAF \\
		\hline
		Точность обнаружения нескольких объектов (Multiple Object Detection Precision (MODP)) & Среднее перекрытие между истинными положительными и эталонными значениями \\
		\hline
		Точность трекинга нескольких объектов(Multiple Object Tracking Precision (MOTP)) & 
		Перекрытие между оцененными позициями и эталонной правдой, усредненное по сопоставлениям  \\ 
		\hline
		Точность трекинга нескольких объектов (MultipleObject Tracking Accurac (MOTA)) & Комбинация ложных отрицательных, ложных положительных и ошибок сопоставления \\
		\hline
		Переключатель ID (ID Switch (IDS)) & Количество раз, когда отслеживаемая траектория меняет свой идентификатор \\
		\hline
	\end{tabularx}
\end{table}
